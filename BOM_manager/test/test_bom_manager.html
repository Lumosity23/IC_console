<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-g">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projet Symbiote - Gestion</title>
    <style>
        /* --- Style Général (CSS) --- */
        :root {
            --bg-color: #1a1a1a;
            --text-color: #f0f0f0;
            --primary-color: #4CAF50; /* Vert Symbiote */
            --header-bg: #2c2c2c;
            --table-border: #444;
            --table-header-bg: #333;
            --table-row-hover: #454545;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background-color: var(--header-bg);
            padding: 1.5rem 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border-left: 5px solid var(--primary-color);
        }

        h1 {
            margin: 0;
            color: var(--primary-color);
        }

        /* --- Section Calculateur --- */
        .calculator {
            background-color: var(--header-bg);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .calculator label {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .calculator input {
            padding: 0.5rem;
            font-size: 1.2rem;
            width: 100px;
            background-color: var(--bg-color);
            color: var(--text-color);
            border: 1px solid var(--table-border);
            border-radius: 4px;
        }

        .calculator .total-cost {
            font-size: 1.5rem;
            font-weight: bold;
            margin-left: auto;
        }

        /* --- Table des Composants --- */
        table {
            width: 100%;
            border-collapse: collapse;
            background-color: var(--header-bg);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--table-border);
        }

        thead {
            background-color: var(--table-header-bg);
        }
        
        tbody tr:hover {
            background-color: var(--table-row-hover);
        }

        td a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: bold;
        }

        td a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Projet Symbiote - Nomenclature & Coûts</h1>
        </header>

        <section class="calculator">
            <label for="quantity">Quantité à produire :</label>
            <input type="number" id="quantity" value="1" min="1">
            <div class="total-cost">
                Coût Total : <span id="total-cost-value">0.00 €</span>
            </div>
        </section>

        <section class="bom">
            <table>
                <thead>
                    <tr>
                        <th>Référence</th>
                        <th>Description</th>
                        <th>Qté/Unité</th>
                        <th>Fournisseur</th>
                        <th>Prix/Unité (€)</th>
                        <th>Total Ligne (€)</th>
                        <th>Lien</th>
                    </tr>
                </thead>
                <tbody id="bom-table-body">
                    <!-- Les lignes seront insérées ici par JavaScript -->
                </tbody>
            </table>
        </section>
    </div>

    <!-- --- Données des Composants (BOM) --- -->
    <script>
        // Normalement dans un fichier séparé (bom-data.js), mais ici pour la simplicité.
        const bomData = [
            { ref: "ESP32-S3-WROOM-1", desc: "MCU Console Hôte", qty: 1, supplier: "LCSC", price: 4.50, link: "#" },
            { ref: "ESP32-C3-MINI-1", desc: "MCU Cartouche", qty: 1, supplier: "LCSC", price: 2.20, link: "#" },
            { ref: "MCP73871", desc: "PMIC Power Path Manager", qty: 2, supplier: "Mouser", price: 2.10, link: "#" }, // Un pour chaque
            { ref: "R_0603_5.1k", desc: "Résistance USB-C CC", qty: 4, supplier: "LCSC", price: 0.01, link: "#" }, // Deux pour chaque
            { ref: "LCD_3.5_SPI", desc: "Écran 3.5 pouces 320x480", qty: 1, supplier: "AliExpress", price: 12.00, link: "#" },
            { ref: "OLED_1.3_I2C", desc: "Écran OLED 1.3 pouces", qty: 1, supplier: "AliExpress", price: 3.50, link: "#" },
            { ref: "Connecteur Mag 6-Pin", desc: "Connecteur Symbiotique", qty: 1, supplier: "AliExpress", price: 4.00, link: "#" },
            { ref: "Boîtier Imprimé 3D", desc: "Coque de la console", qty: 1, supplier: "Local", price: 15.00, link: "#" } // Estimation
            // Ajoutez d'autres composants ici...
        ];
    </script>

    <!-- --- Logique Applicative (JavaScript) --- -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const quantityInput = document.getElementById('quantity');
            const bomTableBody = document.getElementById('bom-table-body');
            const totalCostValueSpan = document.getElementById('total-cost-value');

            function calculateAndRender() {
                const quantity = parseInt(quantityInput.value) || 1;
                let grandTotal = 0;

                // Vider le tableau actuel
                bomTableBody.innerHTML = '';

                // Remplir le tableau avec les données
                bomData.forEach(item => {
                    const lineTotal = item.qty * item.price;
                    grandTotal += lineTotal;

                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.ref}</td>
                        <td>${item.desc}</td>
                        <td>${item.qty}</td>
                        <td>${item.supplier}</td>
                        <td>${item.price.toFixed(2)}</td>
                        <td>${lineTotal.toFixed(2)}</td>
                        <td><a href="${item.link}" target="_blank">Lien</a></td>
                    `;
                    bomTableBody.appendChild(row);
                });

                // Mettre à jour le coût total
                const finalCost = grandTotal * quantity;
                totalCostValueSpan.textContent = `${finalCost.toFixed(2)} €`;
            }

            // Écouter les changements sur le champ de quantité
            quantityInput.addEventListener('input', calculateAndRender);

            // Calcul initial au chargement de la page
            calculateAndRender();
        });
    </script>

</body>
</html>
